{% extends "myschedule/base-sidebar.html" %}

{% load myschedule_filters %}

{% block scripts %}{{ block.super }}
   <script type="text/javascript">
     var basePath = '{% url index %}';
     var buttonPath = '{% url appstatic "img/remove_button.png" %}';
   </script>
  <script type="text/javascript" src="{% url appstatic "js/sections.js" %}"></script>
{% endblock %}

{% block page_title %}{{ block.super }} | Search Results{% endblock %}
{% block buttons %} {% endblock %}
{% block content %}{{ block.super }}
  {% include "myschedule/search.html" %}
  {% if not user.is_authenticated or conflicts.conflicting_sections %}
    <br />
    <div class="message message-warning" id="conflict-login-message">
    {% if not user.is_authenticated %}
      <p id="login-message"><a href="{% url schedule_login request.path %}">Sign in</a> to save this schedule!</p>
    {% endif %}
    {% if conflicts.conflicting_sections %}
      <p id="conflict-message">This schedule contains scheduling conflicts.</p>
    {% endif %}
    </div>
  {% endif %}
  {% if sections %}
    <form action="" method="POST" id="section-form">
      <div class="course">
        <div class="course-top"></div>
        <div class="course-content">
          <div class="course-metadata">
            <p class="course-number">{{ sections.0.course.prefix }} {{ sections.0.course.course_number }}</p>
            <p class="course-hours">{% ifequal sections.0.course.academic_level 'Corporate and Continuing Education' %}CEUs<br/>{{ sections.0.ceus }}{% endifequal %}{% ifequal sections.0.course.academic_level 'Curriculum' %}Credit Hours<br/>{{ sections.0.credit_hours }}{% endifequal %}</p>
          </div>
         <div class="course-description">
            <p class="course-name">{{ sections.0.course.title }}</p>
            <p>{{ sections.0.course.description }}</p>
            <p class="contact-hours">Contact Hours {{ section.0.contact_hours }}</p>
            {% if sections.0.course.note %}<p class="course-note"><a class="open-window" href="#note" ref="show-note" dialog-title="Notes" dialog-note="{{ sections.0.course.note }}">Notes </a></p>{% endif %}
          </div>
          <div class="clear"></div>
        </div>
        <div class="course-bottom"></div>
      </div>
              
      {% for section in sections %}
        <div class="section" id="{{ section.section_code }}">

          <div class="section-top">
            <div class="section-number">Section {{ section.section_number }}</div>
            <div class="section-heading">Meets</div>
            <a class="add-item" href="#add" ref="section_{{ section.section_code }}"><img src="{% url appstatic "img/add_button.png" %}" alt="Add" /></a>
          </div>
          <div class="section-content">
            <div class="section-seats">
              <table>
                {% if section.seat_count != "Seat count unavailable" %}
                  <tr>
                    <td class="section-seats-label">Seats Available</td>
                  </tr>
                  <tr>
                    <td class="section-seats-number">{{ section.seat_count }}</td>
                  </tr>
                {% else %}
                  <tr>
                    <td class="section-seats-label">{{ section.seat_count }}</td>
                    </tr>
                {% endif %}
                {% ifnotequal section.tuition "0.00" %}
                  <tr>
                    <td class="section-tuition">Tuition ${{ section.tuition }}</td>
                  </tr>
                {% endifnotequal %}
              </table>
            </div>

            <div class="section-meeting">
              <table>
              {% for meeting in section.meeting_set.all %}
                <tr>
                  <td class="section-campus">{{ section.campus }}</td>
                  <td class="section-room">Rm {{ meeting.building }} {{ meeting.room }}</td>
                  <td class="section-type">{{ meeting.meeting_type }}</td>
                  <td class="section-days">{{ meeting.days_of_week|days_of_week }}</td>
                  <td class="section-time">{{ meeting.start_time|time:"g:i A" }} - {{ meeting.end_time|time:"g:i A" }}</td>
                </tr>
              {% endfor %}
              <tr>
                <td colspan="2"><strong>From</strong> {{ section.start_date|date:"n-j-Y" }} <strong>to</strong> {{ section.end_date|date:"n-j-Y" }}</td>
                <td colspan="3"><strong>Session</strong> {{ section.session }}</td>
              </tr>
              <tr>
                <td colspan="6">{{section.delivery_type }}</td>
              </tr>
              </table>
            </div>
            <div class="clear"></div>
          </div>
          <div class="section-bottom">
            <div class="section-synonym">Synonym {{ section.synonym }}</div>
            <div class="section-instructor"><strong>Instructor</strong> {% if section.instructor_link %}<a href="{{ section.instructor_link }}">{{ section.instructor_name }}</a>{% else %}{{ section.instructor_name }}{% endif %}
            </div>
            <div class="section-books">
            {% if section.book_link %} <a class="open-window" ref="book" dialog-title="Book Information" href= "#book" booklink="{{ section.book_link }}">Book Information</a> <img src="{% url appstatic "img/books_icon.png" %}" alt="Book" />{% endif %}<br/>
            {% if section.note %}<a class="open-window" ref="show-note" dialog-title="Notes" dialog-note="{{ section.note }}" href="#note">Notes</a>{% endif %}
            </div>
          </div>
          <div class="clear"></div>
        </div>
      {% endfor %}
      {% include "myschedule/dialogs/book.html" %}
      {% include "myschedule/dialogs/show_note.html" %}
    </form>
  {% else %}
    <p>There are no sections currently available for this course.</p>
  {% endif %}
{% endblock %}

