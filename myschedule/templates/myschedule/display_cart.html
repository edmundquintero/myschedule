{% extends "myschedule/base-sidebar.html" %}

{% load myschedule_filters %}

{% block page_title %}{{ block.super }} | Schedule{% endblock %}

{% block schedule %}{% endblock %}

{% block content %}{{ block.super }}
{% include "myschedule/search.html" %}
{% if not sections %}
  <br />
  <div class="message message-warning">
    <p>All classes have been removed from this schedule.</p>
  </div>
{% else %}
  {% if not user.is_authenticated or conflicts.conflicting_sections %}
    <br />
    <div class="message message-warning" id="conflict-login-message">
    {% if not user.is_authenticated %}
      <p id="login-message"><a href="{% url login %}">Sign in</a> to save this schedule!</p>
    {% endif %}
    {% if conflicts.conflicting_sections %}
      <p id="conflict-message">Scheduling conflicts are highlighted below.</p>
    {% endif %}
    </div>
  {% endif %}
  <a class="open-window ui-button" href="#email" ref="email" dialog-title="Email Schedule" title="Email this schedule to yourself or a friend">Email Schedule</a>
  <a href="#print" title="Print this page" class="print-schedule ui-button">Print Schedule</a>

  {% for section in sections %}
    <div class="section">
      <div class="section-top">
        <div class="section-number">{{ section.course.prefix }} {{ section.course.course_number }} - {{ section.section_number }} </div>
        <div class="section-heading">{{ section.course.title }} Synonym: {{ section.synonym }}</div>
        <a class="remove-link" href="#remove" ref="{{ section.section_code }}"><img src="{% url appstatic "img/remove_button.png" %}" alt="Remove" /></a>

      </div>
      <div class="section-content">
        <div class="section-seats">
          {% if section.seat_count != "Seat count unavailable" %}
            <p class="section-seats-label">Seats Available</p>
            <p class="section-seats-number">{{ section.seat_count }}</p>
          {% else %}
            <p class="section-seats-label">{{ section.seat_count }}</p>
          {% endif %}
        </div>
        <div class="section-meeting">
          <table>
            {% for meeting in section.meeting_set.all %}
              <tr>
                <td class="section-campus">{{ section.campus }}</td>
                <td class="section-room">Rm {{ meeting.building }} {{ meeting.room }}</td>
                <td class="section-type">{{ meeting.meeting_type }}</td>
                <td class="section-days">{{ meeting.days_of_week|days_of_week }}</td>
                <td class="section-time{% if meeting.id in conflicts.conflicting_meetings %} error{% endif %}" id="{{ meeting.id }}">{{ meeting.start_time|time:"g:i A" }} - {{ meeting.end_time|time:"g:i A" }}</td>
              </tr>
            {% endfor %}
            <tr>
              <td colspan="2"><strong>From</strong> {{ section.start_date|date:"n-j-Y" }} to {{ section.end_date|date:"n-j-Y" }}</td>
              <td colspan="3"><strong>Session</strong> {{ section.session }}</td>
            </tr>
          </table>
        </div>
        <div class="clear"></div>
      </div>
      <div class="section-bottom">
        <div class="section-hours"><strong>Contact Hours</strong> {{ section.contact_hours }}</div>
        <div class="section-instructor"><strong>Instructor</strong> {% if section.instructor_link %}<a href="{{ section.instructor_link }}">{{ section.instructor_name }}</a><span class="print-only print-link instructor-link"> {{ section.instructor_link }}</span>{% else %}<span class="instructor-name">{{ section.instructor_name }}</span>{% endif %}
        </div>
        <div class="section-books do-not-print">
          {% if section.book_link %} <a class="open-window" ref="book" dialog-title="Book Information" href= "#book" booklink="{{ section.book_link }}">Book Information</a> <img src="{% url appstatic "img/books_icon.png" %}" alt="Book" />{% endif %}

        </div>

        <div class="clear"></div>
      </div>
      <div class="print-only">
        <span class="print-label">Book Information </span><span class="print-link">{{ section.book_link }}</span></div>
    </div>
  {% endfor %}

  {% include "myschedule/dialogs/book.html" %}
  {% include "myschedule/dialogs/email.html" %}
{% endif %}
{% endblock %}
